# 字体加载优化方案

小米使用的方案：https://font.sec.miui.com/font/css?family=MiSans:400,450,500,600:Chinese_Simplify,Latin&display=swap

在定义自定义字体时，利用了`unicode-range`属性，当遇到该属性中指定的字体时，就加载对应的字体文件，也就是说，它通过将一个字体文件拆成多个小的字体文件，再配合`unicode-range`属性，动态加载字体

关于`font-display`的描述见[MDN](https://developer.mozilla.org/en-US/docs/Web/CSS/@font-face/font-display)

- block

  一开始隐藏文本并等待字体加载，如果字体在短时间内未加载完成，则回退字体，一旦自定义字体加载完成，浏览器将切换文本以使用自定义字体。此方法可能会导致在等待字体加载时出现“闪烁的不可见文本”（FOIT）

- swap

  浏览器立即使用回退字体显示文本，并在自定义字体加载完成后切换到自定义字体。这种方法可能会导致“闪烁的未样式化文本”（FOUT），但确保文本从一开始就对用户可见

- fallback

  是block和swap的组合。浏览器最初会短暂隐藏文本（通常约100毫秒）。如果自定义字体在此期间加载完成，浏览器将显示它。否则，它将显示回退字体。经过较长时间（通常约三秒），如果自定义字体仍未加载完成，浏览器将放弃并继续使用回退字体

- optional

  类似于fallback，但自定义字体加载的等待时间较短。如果自定义字体在这个较短的时间内（依赖于浏览器）未加载完成，浏览器将放弃并继续使用回退字体。这种方法将用户体验和性能放在优先考虑，而不是完全准确的字体呈现

## 前端领域字符表示方式：

1. HTML中字符输出使用`&#x`配上charCode值；
2. 在JavaScript文件中为防止乱码转义，则是`\u`配上charCode值；
3. 而在CSS文件中，如CSS伪元素的`content`属性，直接使用`\`配上charCode值。
4. `unicode-range`是`U+`配上charCode值。

## unicode-range的常用unicode值及获取

对于我们中文用户，最常用的有下面这些：

汉字：`[0x4e00,0x9fa5]`（或十进制`[19968,40869]`）
数字：`[0x30,0x39]`（或十进制`[48, 57]`）
小写字母：`[0x61,0x7a]`（或十进制`[97, 122]`）
大写字母：`[0x41,0x5a]`（或十进制`[65, 90]`）

|                            字符集                            |  字数   | Unicode 编码 |
| :----------------------------------------------------------: | :-----: | :----------: |
| [基本汉字](https://www.zhangxinxu.com/study/201611/show-character-by-charcode.php?range=4E00-9FA5) | 20902字 |  4E00-9FA5   |
| [基本汉字补充](https://www.zhangxinxu.com/study/201611/show-character-by-charcode.php?range=9FA6-9FCB) |  38字   |  9FA6-9FCB   |
| [扩展A](https://www.zhangxinxu.com/study/201611/show-character-by-charcode.php?range=3400-4DB5) | 6582字  |  3400-4DB5   |
| [扩展B](https://www.zhangxinxu.com/study/201611/show-character-by-charcode.php?range=20000-2A6D6) | 42711字 | 20000-2A6D6  |
| [扩展C](https://www.zhangxinxu.com/study/201611/show-character-by-charcode.php?range=2A700-2B734) | 4149字  | 2A700-2B734  |
| [扩展D](https://www.zhangxinxu.com/study/201611/show-character-by-charcode.php?range=2B740-2B81D) |  222字  | 2B740-2B81D  |
| [康熙部首](https://www.zhangxinxu.com/study/201611/show-character-by-charcode.php?range=2F00-2FD5) |  214字  |  2F00-2FD5   |
| [部首扩展](https://www.zhangxinxu.com/study/201611/show-character-by-charcode.php?range=2E80-2EF3) |  115字  |  2E80-2EF3   |
| [兼容汉字](https://www.zhangxinxu.com/study/201611/show-character-by-charcode.php?range=F900-FAD9) |  477字  |  F900-FAD9   |
| [兼容扩展](https://www.zhangxinxu.com/study/201611/show-character-by-charcode.php?range=2F800-2FA1D) |  542字  | 2F800-2FA1D  |
| [PUA(GBK)部件](https://www.zhangxinxu.com/study/201611/show-character-by-charcode.php?range=E815-E86F) |  81字   |  E815-E86F   |
| [部件扩展](https://www.zhangxinxu.com/study/201611/show-character-by-charcode.php?range=E400-E5E8) |  452字  |  E400-E5E8   |
| [PUA增补](https://www.zhangxinxu.com/study/201611/show-character-by-charcode.php?range=E600-E6CF) |  207字  |  E600-E6CF   |
| [汉字笔画](https://www.zhangxinxu.com/study/201611/show-character-by-charcode.php?range=31C0-31E3) |  36字   |  31C0-31E3   |
| [汉字结构](https://www.zhangxinxu.com/study/201611/show-character-by-charcode.php?range=2FF0-2FFB) |  12字   |  2FF0-2FFB   |
| [汉语注音](https://www.zhangxinxu.com/study/201611/show-character-by-charcode.php?range=3105-3120) |  22字   |  3105-3120   |
| [注音扩展](https://www.zhangxinxu.com/study/201611/show-character-by-charcode.php?range=31A0-31BA) |  22字   |  31A0-31BA   |
| [〇](https://www.zhangxinxu.com/study/201611/show-character-by-charcode.php?range=3007) |   1字   |     3007     |

|                            字符集                            | 字数 | Unicode 编码 |
| :----------------------------------------------------------: | :--: | :----------: |
| [数字0-9](https://www.zhangxinxu.com/study/201611/show-character-by-charcode.php?range=30-39) | 10字 |    30-39     |
| [小写英文字母](https://www.zhangxinxu.com/study/201611/show-character-by-charcode.php?range=61-7a) | 26字 |    61-7a     |
| [大写英文字母](https://www.zhangxinxu.com/study/201611/show-character-by-charcode.php?range=41-5a) | 26字 |    41-5a     |

工具：

1. [显示特定charcode范围内的字符内容](https://www.zhangxinxu.com/study/201611/show-character-by-charcode.php?range=0025-0099) 通过在url上拼接`?range=0025-0099`这样的参数即可以查询u+0025到u+0099的字符串是哪些
2. [任意字符转正html识别的格式](https://www.zhangxinxu.com/sp/char.html)
3. 

## 引用

[CSS unicode-range特定字符使用font-face自定义字体——by 张鑫旭](https://www.zhangxinxu.com/wordpress/2016/11/css-unicode-range-character-font-face/)

